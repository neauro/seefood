<%  # todo: get most popular (based on food rating, or popularity of photo?) photo
    # for now, it's just the first menuitem for this restaurant
    # and last menu item for this restaurant is the "most recent" one
    top_menu_item = @restaurant.menu_items[0]
    recent_menu_item = @restaurant.menu_items[-1]
%>

<!-- begin left column on page -->
<div id="food-data">
    <div class="food-data-box">
        <!-- todo: grab the menu item with the most ratings, and place data from it here -->
        <!-- todo: make this part cooler, i.e. different colored background or "award" icon -->
        <h1>Most Popular Food</h1>
        <div class="big-menuitem-image">
            <!-- todo: post a picture here -->
            stub for 350x250 picture
        </div>
        <div class="review-info">
            <%= link_to top_menu_item.name, top_menu_item %> at
            <%= link_to @restaurant.name, restaurant_path(@restaurant) %><br/>
            <!-- todo: link this to a profile view -->
            by <a href="profile.html">nadine</a><br/>
            <!-- todo: get the date that the rating was uploaded -->
            <span class="rating-date"><strong>Date Taken:</strong> March 3, 2001</span><br/>
            <!-- todo: get the rating of the picture dynamically -->
            <span class="picture-rating"><strong>Picture Rating:</strong> 5 stars</span><br/>
            <p class="desc">
                <!-- todo: get the description of this review -->
                These burritos are the size of small children and just as delicious!
            </p>
        </div>
    </div>
    
    <div class="food-data-box">
        <!-- todo: get the most recently uploaded review -->
        <h1>Most Recent Picture</h1>
        <div class="big-menuitem-image">
            stub for 350x250 picture
        </div>
        <div class="review-info">
            <%= link_to recent_menu_item.name, recent_menu_item %> at
            <%= link_to @restaurant.name, @restaurant %><br/>
            by <a href="profile.html">nadine</a><br/>
            <!-- todo: get the average of what users have rated this picture) -->
            <span class="rating-date"><strong>Date Taken:</strong> March 3, 2001</span><br/>
            <!-- todo: get the review of the picture dynamically -->
            <span class="picture-rating"><strong>Picture Rating:</strong> 5 stars</span><br/>
            <p class="desc">
                <!-- todo: get the description of this rating -->
                These burritos are the size of small children and just as delicious!

            </p>
        </div>
    </div>
</div>
<!-- end left column on page -->


<!-- begin right column on page -->
<div id="content">
    <p id="notice"><%= notice %></p>
    <!-- todo: make this button lead to "upload a menu item to this restaurant" page -->
    <div class="button"><%= link_to "Upload your own picture to "+@restaurant.name+"?", new_menu_item_path(@restaurant)%></div>
    <h1><%= link_to @restaurant.name, @restaurant %></h1>
    <h2> at <%= @restaurant.address %></h2>


    <table id="info">
        <tr>
            <!-- todo: get the first contributor to this restaurant
            (the one who added this restaurant to the database,
             or the first person to add a picture) -->
            <td>First Contributor</td>
            <td>nadine (contributed <%= link_to top_menu_item.name, menu_item_path(top_menu_item) %>)</td>
        </tr>
        <tr>
            <!-- todo: count of how many menu items exist at seefood for this restaurant -->
            <td>Number of Menu Items on Seefood:</td>
            <td><%= @restaurant.menu_items.count %></td>
        </tr>
        <tr>
            <!-- todo: count of unique contributors to this restaurant -->
            <td>Number of contributors to <%= @restaurant.name %></td>
            <td>1</td>
        </tr>
        <tr>
            <td>Number of Reviews</td>
            <td><%= @restaurant.menu_items.map{|m| m.reviews.count}.sum %></td>
        </tr>

        <tr>
            <!-- todo: average price of all menu items for this restaurant -->
            <td>Average Price of Menu Items on Seefood</td>
            <td>$<%= "%.2f" % (@restaurant.menu_items.map{|m| m.price}.sum/@restaurant.menu_items.count) %></td>
        </tr>
        <tr>
            <!-- todo: link to a list of all users who put a star rating on this menuitem (?) this is not a menu item!-->
            <td>Average Rating</td>
            <td>3.5 stars (voted on by <a href="">16 people</a>)</td>
        </tr>
        <tr>
            <!-- todo: get the tags for this restaurant? -->
            <td>Details</td>
            <td><a href="">Mexican</a>, <a href="">lunch</a>, <a href="">dinner</a></td>
        </tr>
        <tr>
            <!-- todo: get the most common words said about menu items for this restaurant? -->
            <td>Common phrases</td>
            <td><a href="">delicious</a>, <a href="">huge</a>, <a href="">cheap</a></td>
        </tr>
    </table>

    <div id="visual-menu">
        <h1>Menu Items at <%= @restaurant.name %></h1>
        <!-- todo: when a sorting option is pressed, sort the ratings -->
        <ul id="sort-options">
            <li>Most recent</li>
            <li>Most popular</li>
            <!-- todo (?): i.e. "show me desserts"...this could also be a dropdown -->
            <li>Type</li>
        </ul>

        <!-- todo: grab the most popular picture of each unique menu item at this restaurant -->
        <!-- todo: actually loop through menu items, show edit destroy -->
        <% @restaurant.menu_items.each do |menu_item| %>
          <div class="rating-item">
              <div class="small-menuitem-image">stub for 130x110 picture </div>
              <%= link_to menu_item.name, menu_item %><br/>
              by <a href="profile">nadine</a>
              ***** <!-- rating for picture?  for food? -->
              <%= link_to 'Edit', edit_menu_item_path(menu_item) %>
              <%= link_to 'Delete', menu_item, :confirm => "Are you sure you want to delete this menu item and all associated reviews?", :method => :delete %></p>
          </div>
        <% end %>
    </div>

    <div id="content-footer">
        <p><%= link_to "New Review", new_menu_item_path(@restaurant) %></p>
        <p><%= link_to 'Edit', edit_restaurant_path(@restaurant) %></p>
        <p><%= link_to 'Back', restaurants_path %></p>
        <p><%= link_to 'Delete restaurant', @restaurant, :confirm => "Are you sure you want to delete this restaurant and all associated menu items and reviews?", :method => :delete %></p>

        <span class="note">
            <!-- todo: make a page which will allow users to report categorization errors -->
            Is this menu item misnamed or misplaced?  <a href="">Let us know!</a>
        </span>
    </div>

</div>
<!-- end right column on page -->
